{"version":3,"file":"circlepack.umd.js","sources":["../../src/Vector2.js","../../src/CirclePackManager.js","../../src/CirclePackPoint.js"],"sourcesContent":["export default class Vector2 {\n  constructor(x, y) {\n    this.x = x || 0;\n    this.y = y || 0;\n  }\n\n  add(vec) {\n    this.x += vec.x;\n    this.y += vec.y;\n\n    return this;\n  }\n\n  copy(vec) {\n    this.x = vec.x;\n    this.y = vec.y;\n\n    return this;\n  }\n\n  distanceTo(vec) {\n    return Math.sqrt(this.distanceToSquared(vec));\n  }\n\n  distanceToSquared(vec) {\n    const dx = this.x - vec.x;\n    const dy = this.y - vec.y;\n\n    return dx * dx + dy * dy;\n  }\n\n  divideScalar(scalar) {\n    this.x /= scalar;\n    this.y /= scalar;\n\n    return this;\n  }\n\n  length() {\n    return Math.sqrt(this.x * this.x + this.y * this.y);\n  }\n\n  multiplyScalar(scalar) {\n    this.x *= scalar;\n    this.y *= scalar;\n\n    return this;\n  }\n\n  normalize() {\n    return this.divideScalar(this.length() || 1);\n  }\n\n  set(x, y) {\n    this.x = x;\n    this.y = y;\n  }\n\n  sub(vec) {\n    this.x -= vec.x;\n    this.y -= vec.y;\n\n    return this;\n  }\n\n  subVectors(vec, vec2) {\n    this.x = vec.x - vec2.x;\n    this.y = vec.y - vec2.y;\n\n    return this;\n  }\n}\n","import Vector2 from './Vector2';\n\nexport default class CirclePackManager {\n  constructor(opts = {}) {\n    this.tightness = 0.5;\n    this.active = true;\n    this.points = [];\n    this.center = opts.center || new Vector2();\n    this.volume = 0;\n    this.updateCallback = opts.onUpdate || null;\n\n    // for optional interaction. positioned offscreen initially\n    this.mouse = new Vector2(window.innerHeight * 2, window.innerHeight * 2);\n    this.mouseRadius = 100;\n    this.mouseInteractive = true;\n\n    this._tmpPointA = new Vector2();\n    this._tmpPointB = new Vector2();\n    this._tmpVec = new Vector2();\n  }\n\n  calculateVolume() {\n    this.volume = 0;\n\n    for (let i = 0, total = this.points.length; i < total; i += 1) {\n      this.volume += this.points[i].radius;\n    }\n  }\n\n  update() {\n    if (!this.active) { return; }\n\n    let dist;\n    let radii;\n    let inverseForce;\n    const pointTotal = this.points.length;\n\n    for (let i = 0; i < pointTotal; i += 1) {\n      for (let j = 0; j < pointTotal; j += 1) {\n        if (j !== i) {\n          dist = this.points[i].position.distanceToSquared(this.points[j].position);\n          radii = (this.points[i].radius + this.points[j].radius) / 3;\n\n          if (dist < radii * radii) {\n            this._tmpVec.subVectors(this.points[i].position, this.points[j].position).normalize();\n\n            inverseForce = (radii - Math.sqrt(dist));\n            this._tmpVec.multiplyScalar(inverseForce / 3);\n\n            this.points[i].velocity.add(this._tmpVec);\n            this.points[j].velocity.sub(this._tmpVec);\n          }\n        }\n      }\n\n      this.points[i].update();\n    }\n\n    if (this.updateCallback) {\n      this.updateCallback.call();\n    }\n  }\n}\n","import Vector2 from './Vector2';\n\nexport default class Point {\n  constructor(opts = {}) {\n    this.position = new Vector2(opts.x, opts.y);\n    this.velocity = new Vector2();\n    this.radius = opts.radius;\n    this.points = opts.pointsArray;\n    this.manager = opts.manager; // reference to CirclePackManager instance\n\n    this.index = opts.index;\n    this._tmpVec = new Vector2(); // reused for various calculations\n\n    this.points[this.index] = this.position.x;\n    this.points[this.index + 1] = this.position.y;\n  }\n\n  update() {\n    const _dist = this.position.distanceTo(this.manager.center);\n\n    this._tmpVec.subVectors(this.manager.center, this.position).multiplyScalar(_dist / 100000000);\n\n    if (_dist > (this.manager.volume / 200) * Math.max(3.5, 80 - this.manager.tightness * 100)) {\n      this._tmpVec.multiplyScalar(1000);\n    }\n\n    this.velocity.add(this._tmpVec);\n\n    if (this.manager.mouseInteractive) {\n      const dist = this.manager.mouse.distanceTo(this.position);\n\n      if (dist < this.manager.mouseRadius) {\n        this._tmpVec.subVectors(this.position, this.manager.mouse).normalize();\n        this.velocity.add(this._tmpVec);\n      }\n    }\n\n    this.velocity.multiplyScalar(0.9);\n    this.position.add(this.velocity);\n\n    this.points[this.index] = this.position.x;\n    this.points[this.index + 1] = this.position.y;\n  }\n}\n"],"names":["Vector2","x","y","add","vec","copy","distanceTo","Math","sqrt","distanceToSquared","dx","dy","divideScalar","scalar","length","multiplyScalar","normalize","set","sub","subVectors","vec2","CirclePackManager","opts","tightness","active","points","center","volume","updateCallback","onUpdate","mouse","window","innerHeight","mouseRadius","mouseInteractive","_tmpPointA","_tmpPointB","_tmpVec","calculateVolume","i","total","radius","update","dist","radii","inverseForce","pointTotal","j","position","velocity","call","Point","pointsArray","manager","index","_dist","max"],"mappings":"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"}